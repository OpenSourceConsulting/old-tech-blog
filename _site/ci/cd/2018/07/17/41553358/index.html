<!DOCTYPE html>
<html>
<head>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-4319643791278273",
    enable_page_level_ads: true
  });
</script>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
 <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<title>Bamboo Agent 설정</title>
<meta name="title" content="Bamboo Agent 설정" />
<meta name="author" content="seiyeon.kim"/>
<meta name="description" content="Bamboo Agent로 Remote Server에서 Job을 실행할 수 있는 환경을 안내드립니다. 전체 순서는 아래와 같습니다. 대상 서버에 Bamboo Agent 설치 Server capabilities 설정 Job 설정 결과 확인 Bamboo Agent 설치 사전 조건 Bamboo Server ↔ Remote Server 방화벽 설정(proxy 사용 시 80, 8085, 54663) Remote Server JDK 1.8 설치 관리자 메뉴의 Agents Install remote agent Agent JAR 파일을 다운로드 받아서 Remote Server에서 실행합니다. #bamboo agent home directory를 생성합니다. /var/atlassian/application-data/bamboo-home #bamboo home path를 지정합니다. java -Dbamboo.home=/var/atlassian/application-data/bamboo-home -jar atlassian-bamboo-agent-installer-6.6.1.jar..."/>

<meta property="fb:app_id" content=""/>

<meta property="og:site_name" content="오픈소스컨설팅 기술 블로그"/>
<meta property="og:type" content="article"/>
<meta property="og:title" content="Bamboo Agent 설정"/>
<meta property="og:description" content="Bamboo Agent로 Remote Server에서 Job을 실행할 수 있는 환경을 안내드립니다. 전체 순서는 아래와 같습니다. 대상 서버에 Bamboo Agent 설치 Server capabilities 설정 Job 설정 결과 확인 Bamboo Agent 설치 사전 조건 Bamboo Server ↔ Remote Server 방화벽 설정(proxy 사용 시 80, 8085, 54663) Remote Server JDK 1.8 설치 관리자 메뉴의 Agents Install remote agent Agent JAR 파일을 다운로드 받아서 Remote Server에서 실행합니다. #bamboo agent home directory를 생성합니다. /var/atlassian/application-data/bamboo-home #bamboo home path를 지정합니다. java -Dbamboo.home=/var/atlassian/application-data/bamboo-home -jar atlassian-bamboo-agent-installer-6.6.1.jar..."/>
<meta property="og:url" content="https://tech.osci.kr/ci/cd/2018/07/17/41553358/"/>
<meta property="og:image" content="https://tech.osci.kr/assets/images/default_blog_cover.jpg"/>
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:title" content="Bamboo Agent 설정"/>
<meta name="twitter:description" content="Bamboo Agent로 Remote Server에서 Job을 실행할 수 있는 환경을 안내드립니다. 전체 순서는 아래와 같습니다. 대상 서버에 Bamboo Agent 설치 Server capabilities 설정 Job 설정 결과 확인 Bamboo Agent 설치 사전 조건 Bamboo Server ↔ Remote Server 방화벽 설정(proxy 사용 시 80, 8085, 54663) Remote Server JDK 1.8 설치 관리자 메뉴의 Agents Install remote agent Agent JAR 파일을 다운로드 받아서 Remote Server에서 실행합니다. #bamboo agent home directory를 생성합니다. /var/atlassian/application-data/bamboo-home #bamboo home path를 지정합니다. java -Dbamboo.home=/var/atlassian/application-data/bamboo-home -jar atlassian-bamboo-agent-installer-6.6.1.jar..."/>
<meta name="twitter:label1" content="Written by"/>
<meta name="twitter:data1" content="seiyeon.kim"/>
<meta name="twitter:image:src" content="https://tech.osci.kr/assets/images/default_blog_cover.jpg"/>
<meta name="naver-site-verification" content="11ec9086ec9292ebc8dc73f6224492f208b2007b"/>
<meta name="google-site-verification" content="Q5w5X0R32gOG-1lBhFg0UxvXRNoQX-uOSPjxPI4sXH4" />

<meta name="twitter:label2" content="Filed under"/>
<meta name="twitter:data2" content="Bamboo,CI/CD,Atlassian"/>

<meta property="article:tag" content="Bamboo"/>

<meta property="article:tag" content="CI/CD"/>

<meta property="article:tag" content="Atlassian"/>



<meta property="article:published_time" content="2018-07-17T00:00:00+09:00"/>


<meta property="article:author" content="https://tech.osci.kr/authors/seiyeon.kim"/>

<link href="https://tech.osci.kr/rss/" rel="alternate" type="application/rss+xml" title="RSS"/>
<link href="/assets/favicon.png" rel="icon" type="image/png"/>
<link href="/assets/apple-touch-icon.png" rel="apple-touch-icon" type="image/png"/>
<link href="/assets/apple-touch-icon.png" rel="apple-touch-icon-precomposed" type="image/png"/>
<link href="/assets/lib/normalize.css" rel="stylesheet" type="text/css"/>
<link href="/assets/css/monokai.css" rel="stylesheet" type="text/css"/>
<link href="/assets/lib/magnific-popup.min.css" rel="stylesheet" type="text/css"/>
<link href="/assets/fonts/Kakao.css" rel="stylesheet" type="text/css"/>
<link href="/assets/css/screen.css" rel="stylesheet" type="text/css"/>

</head>
<body class="post-template">

<div id="header">
    <button id="menu-toggle" type="button">
        <span class="sr-only">Toggle Navigation Menu</span>
    </button>
    <button id="search-toggle" type="button">
        <span class="sr-only">Toggle Search Form</span>
    </button>
    <a href="/" id="logo">
    </a>
    <form id="search">
        <input id="searchQueryEdit" name="q" type="search" placeholder="Search..." value="" />
    </form>

    <ul id="menu" class="nav">
        <li class=" active "><a href="/">Blog</a></li>
        <!--<li class=""><a href="/books/">Books</a></li>-->
        <li class=""><a href="/about/">About</a></li>
    </ul>
</div><!-- #header -->


<div id="wrapper">
    <div id="fb-root"></div>
<div id="navbar" class="container">
    <h5><a id="link-back" href="/">Back to Posts</a></h5>
    
<ul id="shares">
    
    <li>
        <a id="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://tech.osci.kr/ci/cd/2018/07/17/41553358/"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <span class="sr-only">Share to Facebook</span>
        </a>
    </li>
    
    
    
</ul>

</div>

<div id="cover" class="container"
     >
    <div>
        <h1>Bamboo Agent 설정</h1>
        <p> </p>
        <p class="right" style="opacity: 0.5">
            
                Bamboo
                ,
            
                CI/CD
                ,
            
                Atlassian
                
            
        </p>
        


    </div>
</div>

<div id="content" class="container post" role="main">
    <div id="post-content"><p>Bamboo Agent로 Remote Server에서 Job을 실행할 수 있는 환경을 안내드립니다.<br />
전체 순서는 아래와 같습니다.</p>

<ul>
  <li>대상 서버에 Bamboo Agent 설치</li>
  <li>Server capabilities 설정</li>
  <li>Job 설정</li>
  <li>결과 확인</li>
</ul>

<h1 id="bamboo-agent-설치">Bamboo Agent 설치</h1>

<ul>
  <li>사전 조건
    <ul>
      <li>Bamboo Server ↔ Remote Server 방화벽 설정(proxy 사용 시 80, 8085, 54663)</li>
      <li>Remote Server JDK 1.8 설치</li>
    </ul>
  </li>
</ul>

<h3 id="관리자-메뉴의-agents">관리자 메뉴의 Agents</h3>
<p><img src="/assets/images/41553358/0" alt="관리자 메뉴" /></p>

<h3 id="install-remote-agent">Install remote agent</h3>
<p><img src="/assets/images/41553358/1" alt="Install remote agent" /></p>

<h3 id="agent-jar-파일을-다운로드-받아서-remote-server에서-실행합니다">Agent JAR 파일을 다운로드 받아서 Remote Server에서 실행합니다.</h3>
<p><img src="/assets/images/41553358/2" alt="" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#bamboo agent home directory를 생성합니다.   </span>
/var/atlassian/application-data/bamboo-home  
<span class="c">#bamboo home path를 지정합니다.</span>
java <span class="nt">-Dbamboo</span>.home<span class="o">=</span>/var/atlassian/application-data/bamboo-home <span class="nt">-jar</span> atlassian-bamboo-agent-installer-6.6.1.jar http://13.209.93.233:8085/agentServer/
</code></pre></div></div>

<p><img src="/assets/images/41553358/3" alt="" /></p>
<ul>
  <li>bamboo-home에 bin, log등 파일 생성을 확인할 수 있습니다.
    <h3 id="approve-this-agent-at-링크로-ip-승인">Approve this agent at 링크로 IP 승인</h3>
  </li>
</ul>

<p><img src="/assets/images/41553358/4" alt="" /></p>

<h3 id="등록된-remote-agent-확인">등록된 Remote Agent 확인</h3>
<p><img src="/assets/images/41553358/5" alt="" /></p>

<h2 id="server-capabilities">Server capabilities</h2>
<p>서버가 할 수 있는 작업들을 Key, Value 또는 환경을 정의합니다.<br />
python, test 값으로 테스트 해보겠습니다.</p>
<h3 id="메뉴는-agents--shared-remote-capabilities-입니다">메뉴는 Agents &gt; Shared remote capabilities 입니다.</h3>

<p><img src="/assets/images/41553358/6" alt="" /></p>

<h3 id="key-value에-python-test를-추가합니다">Key, Value에 python, test를 추가합니다.</h3>
<p><img src="/assets/images/41553358/7" alt="" /></p>

<p>이제 Remote Agent에 작업을 실행해 보겠습니다.</p>

<h2 id="job-설정">Job 설정</h2>
<p>Job에서 Requirements를 선택하여 사전에 정의한 python을 선택합니다.<br />
아래 Python Code로 테스트를 진행 했습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#file wirte test#/opt/test.py</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"/opt/pyText.txt"</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">d line </span><span class="se">\n</span><span class="s">"</span> <span class="o">%</span> <span class="n">i</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>
<ul>
  <li>Task &gt; Requirements 선택하여 Remote Agent의 capabilities에서 정의한 값 선택</li>
</ul>

<p><img src="/assets/images/41553358/8" alt="" /></p>

<ul>
  <li>Script 명령어 작성</li>
</ul>

<p><img src="/assets/images/41553358/9" alt="" /></p>

<h2 id="결과확인">결과확인</h2>
<h3 id="run-plan">Run plan</h3>

<p><img src="/assets/images/41553358/10" alt="" /></p>

<h3 id="remote-agent의-python-sample-code-실행-결과">Remote Agent의 python sample code 실행 결과</h3>

<p><img src="/assets/images/41553358/11" alt="" /></p>

<p>서버에 Agent 설치 부터 실행까지 해봤습니다. 중간에 capabilities 설정이 생소합니다.<br />
Plan의 여러 Task들이 capabilities에 의해서 여러 Agent의 실행 결과에 따라 빌드를 수행할 수 있습니다.<br />
API 빌드 결과에 따라서 다음 API 서버의 작업을 다르게 설정할 수 있는 유연한 계획을 수립할 수 있습니다.</p>

<p>Bamboo Server와 Agent간의 방화벽 허용도 중요합니다. Proxy서버에서 8085는 처리할 수 있지만 54663 포트는 proxy를 하지 않도록 권장하고 있습니다.</p>

<p>Bamboo는 UI/UX가 군더더기 없고 깔끔해서 관리하기가 좋은 것 같습니다.
또한 Jira, Bitbucket과 강력한 통합 환경을 제공하는데요 이 내용은 다음에 공유하도록 하겠습니다.
감사합니다.</p>
</div>

    <div id="post-footer">
        
        <a id="post-author" href="/authors/seiyeon.kim/">
            <div id="author-image" style="background-image:url(/files/authors/it2seiyon.jpeg);">
                <span class="sr-only">seiyeon.kim's profile image</span>
            </div>
            <p id="author-name">seiyeon.kim</p>
        </a>
        <p id="post-date">2018-07-17</p>
        <a id="post-more" href="/authors/seiyeon.kim/">
            <span>Read more posts by this author</span>
        </a>
    </div>
</div>

<div id="post-links" class="container">
    
    
        <div id="post-prev"
             >
            <div>
                <h3><a href="/opensource,%20github,%20jekyll/2018/07/03/migration-github-blog/">GitHub Page 블로그 이전</a></h3>
                <p>YOU MIGHT ENJOY</p>
            </div>
        </div>
    
    
    
        <div id="post-next"
             >
            <div>
                <h3><a href="/confluence,%20atlassian/2018/07/23/confluence-style/">ConfluencePage CSS꾸미기</a></h3>
                <p>NEXT POST</p>
            </div>
        </div>
    
</div>

<div id="lightbox">
    <div id="lightbox-image"></div>
</div>


    <div class="clearfix"></div>

    <a href="#" id="back-to-top"></a>
</div>

<div id="footer" class="container-fluid">
    <ul id="links">
        
        <li>
            <a id="link-github" href="http://github.com/opensourceconsulting" target="_blank">
                <span class="sr-only">github</span>
            </a>
        </li>
        
        
        <li>
            <a id="link-facebook" href="http://facebook.com/osckorea" target="_blank">
                <span class="sr-only">facebook</span>
            </a>
        </li>
        
        
        <li>
            <a id="link-rss" href="/rss" target="_blank">
                <span class="sr-only">rss</span>
            </a>
        </li>
    </ul>
    <!--
    <ul id="footer-menu">
        <li><a href="//www.kakaocorp.com">Kakao</a></li>
        <li><a href="//www.kakaocorp.com/recruit/currentOpportunities">Jobs</a></li>
        <li><a href="//privacy.kakaocorp.com">Privacy</a></li>
    </ul>
    -->
    <p id="copyright">
        <a href="https://tech.osci.kr">&copy; OpenSourceConsulting</a>
        All rights reserved.
    </p>
</div><!--#footer-->


<script src="/assets/lib/jquery-1.12.0.min.js"></script>
<script src="/assets/lib/jquery.magnific-popup.min.js"></script>
<script src="/assets/js/index.js"></script>


<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
        a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-39977834-4', 'auto');
    ga('send', 'pageview');
</script>





    
    <script>
    window.fbAsyncInit = function() {
        FB.init({
            appId      : '',
            xfbml      : true,
            version    : 'v2.8'
        });
        FB.Canvas.getPageInfo(
            function(info) {
                alert('Width: ' + info.clientWidth + ' Height: ' + info.clientHeight);
            }
        );
        FB.AppEvents.logPageView();
    };

    (function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/ko_KR/sdk.js#xfbml=1&version=v2.8";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>

<!--
<script>
    (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/ko_KR/sdk.js#xfbml=1&version=v2.8";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>
-->

    

    

    

</body>
</html>
